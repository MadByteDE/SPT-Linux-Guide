## SPT Lutris installer v2025.1-2 ##
## This Lutris installer is using an -UNOFFICIAL- SPT installer script.
description: 'Installs the BSG Launcher & SPT for you. The game needs to be installed manually!'
notes: "Please check out the link for further details & assistence"
credits: "https://github.com/MadByteDE/SPT-Linux-Guide"
game_slug: escape-from-tarkov
installer_slug: sptarkov-additions-latest
name: SPTarkov - Launcher
runner: wine

script:
    files:
    - eft:
        url: https://prod.escapefromtarkov.com/launcher/download
        filename: BsgLauncher.exe
    - spt-linux-additions:
        url: https://raw.githubusercontent.com/MadByteDE/SPT-Linux-Guide/refs/heads/main/installers/spt-linux-additions
        filename: spt-linux-additions
    game:
        arch: win64
        exe: drive_c/SPTarkov/SPT.Launcher.exe
        prefix: $GAMEDIR
        launch_configs:
        - exe: SPT.Server.exe
          name: SPTarkov - Server
        - exe: BsgLauncher.exe
          name: BSG Launcher
          args: --disable-software-rasterizer
          working_dir: $GAMEDIR/drive_c/Battlestate Games/BsgLauncher
    installer:
    - task:
        name: create_prefix
        overrides:
            mscoree: d
        arch: win64
    - extract:
        description: Installing BSG Launcher ...
        dst: $GAMEDIR/drive_c/Battlestate Games/BsgLauncher/
        file: eft
        format: gog
    - task:
        app: arial times vcrun2022 dotnetdesktop6 dotnetdesktop8
        arch: win64
        description: Installing game dependencies ...
        name: winetricks
        prefix: $GAMEDIR
    - task:
        app: dotnet48
        arch: win64
        description: Installing .NET 4.8 (This can take a while ...)
        name: winetricks
        prefix: $GAMEDIR
    - task:
        name: winekill
    - task:
        description: Adding mouse focus workaround registry key ...
        name: set_regedit
        path: HKEY_CURRENT_USER\Software\Wine\X11 Driver
        key: UseTakeFocus
        value: N
    - task:
        app: win10
        arch: win64
        description: Setting windows version to Windows 10...
        name: winetricks
        prefix: $GAMEDIR
    - task:
        arch: win64
        description: Launching BSG Launcher ...
        executable: $GAMEDIR/drive_c/Battlestate Games/BsgLauncher/BsgLauncher.exe
        name: wineexec
        args: --disable-software-rasterizer
        working_dir: $GAMEDIR/drive_c/Battlestate Games/BsgLauncher
    - task:
        name: winekill
    - merge:
        src: spt-linux-additions
        dst: $GAMEDIR
    - chmodx: ./spt-linux-additions
    - execute:
        command: NO_ANSI=1 ./spt-linux-additions install -np "$GAMEDIR"
        description: Installing SPT ...
    # Installation complete
    install_complete_text: "All done! ※\\(^o^)/※\n
                     \n
                     Quick start:\n
                     1. Launch 'SPTarkov - Server'\n
                     2. Launch 'SPTarkov - Launcher'\n
                     3. Create a new profile & play\n
                     \n
                     For the latest updates & mods, visit:\n
                     https://hub.sp-tarkov.com/\n
                     \n
                     Have fun! ('-')7"
    system:
        env:
            PROTON_VERB: run
            # Possible workarounds for dotnet package issues (SPT Launcher)
            # DOTNET_BUNDLE_EXTRACT_BASE_DIR:
            # DOTNET_ROOT: 
        # Without terminal mode the server won't run!
        terminal: true
    wine:
        overrides:
            winhttp: n,b
            icu: d

slug: sptarkov
version: sptarkov-additions-latest
year: 2017
